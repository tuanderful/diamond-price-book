function getPriceTableIndex(caratSize){return caratSize>=.01&&.03>=caratSize?1:caratSize>=.04&&.07>=caratSize?2:caratSize>=.08&&.14>=caratSize?3:caratSize>=.15&&.17>=caratSize?4:caratSize>=.18&&.22>=caratSize?5:caratSize>=.23&&.29>=caratSize?6:caratSize>=.3&&.39>=caratSize?7:caratSize>=.4&&.49>=caratSize?8:caratSize>=.5&&.69>=caratSize?9:caratSize>=.7&&.89>=caratSize?10:caratSize>=.9&&.99>=caratSize?11:caratSize>=1&&1.49>=caratSize?12:caratSize>=1.5&&1.99>=caratSize?13:caratSize>=2&&2.99>=caratSize?14:caratSize>=3&&3.99>=caratSize?15:caratSize>=4&&4.99>=caratSize?16:caratSize>=5&&5.99>=caratSize?17:void 0}function getOversizePremium(carat){return carat>=.6&&.69>=carat?{min:7,max:10,caratMin:.6,caratMax:.69}:carat>=.8&&.89>=carat?{min:7,max:12,caratMin:.8,caratMax:.89}:carat>=.95&&.99>=carat?{min:5,max:10,caratMin:.95,caratMax:.99}:carat>=1.25&&1.49>=carat?{min:5,max:10,caratMin:1.25,caratMax:1.49}:carat>=1.7&&1.99>=carat?{min:7,max:12,caratMin:1.7,caratMax:1.99}:carat>=2.5&&2.99>=carat?{min:5,max:10,caratMin:2.5,caratMax:2.99}:carat>=3.5&&3.99>=carat?{min:5,max:10,caratMin:3.5,caratMax:3.99}:carat>=4.5&&4.99>=carat?{min:5,max:10,caratMin:4.5,caratMax:4.99}:null}function getTotalCost(model){var ptIndex=getPriceTableIndex(model.carat),actualColor=CONSTANTS.color[model.color];return multiplier=PRICE_TABLE[ptIndex][actualColor][model.clarity],totalCost=100*multiplier*model.carat,number=totalCost.toString(),dollars=number.split(".")[0],formattedTotal=dollars.split("").reverse().join("").replace(/(\d{3}(?!$))/g,"$1,").split("").reverse().join(""),formattedTotal}var CONSTANTS={color:["D","E","F","G","H","I","J","K","L","M"],clarity:["IF","VVS1","VVS2","VS1","VS2","SI1","SI2","SI3","I1","I2","I3"]},BOUNDS={color:CONSTANTS.color.length-1,clarity:CONSTANTS.clarity.length-1},PRICE_TABLE={11:{D:[152,118,103,88,77,70,62,48,38,22,15],E:[118,103,94,79,73,65,59,45,37,21,14],F:[103,94,84,74,69,63,55,43,36,20,14],G:[93,84,74,69,64,59,52,41,34,19,13],H:[85,74,69,63,60,55,49,38,32,18,13],I:[70,62,59,55,52,50,44,34,30,17,12],J:[54,51,49,47,46,44,39,31,26,16,11],K:[44,42,40,38,37,35,32,26,23,15,10],L:[39,37,35,34,32,30,27,23,20,14,9],M:[36,34,32,30,29,27,24,21,17,12,8]},12:{D:[275,195,170,133,116,88,75,60,47,27,17],E:[190,165,133,115,102,85,71,58,45,26,16],F:[160,133,116,107,92,82,69,56,44,25,15],G:[130,116,106,91,85,78,66,54,43,24,14],H:[106,98,89,81,77,71,63,51,41,23,14],I:[88,83,76,72,69,66,59,47,37,22,13],J:[75,70,67,64,60,57,54,42,32,20,13],K:[63,60,57,55,53,50,46,37,30,18,12],L:[54,52,50,48,46,44,40,34,28,17,11],M:[47,43,40,38,36,34,31,27,25,16,11]},13:{D:[336,243,211,177,155,115,93,72,54,31,18],E:[238,206,177,160,142,112,90,70,51,30,17],F:[206,177,153,140,127,107,86,67,50,29,16],G:[166,150,135,120,115,101,81,65,49,28,16],H:[134,125,113,105,100,92,76,61,47,27,16],I:[107,102,96,89,85,80,69,56,43,25,15],J:[93,86,82,77,72,67,61,49,38,23,15],K:[74,70,67,65,62,57,52,43,35,20,14],L:[62,60,58,56,54,50,45,38,32,19,13],M:[52,49,46,44,42,41,39,33,28,18,13]},14:{D:[1025,670,580,469,364,235,165,97,78,40,21],E:[666,582,490,410,334,215,160,92,73,38,20],F:[579,490,412,343,304,195,155,87,68,36,19],G:[445,389,340,300,250,180,140,82,66,35,18],H:[327,305,276,250,205,155,130,78,64,34,18],I:[242,228,217,200,170,135,115,73,60,32,17],J:[186,178,176,165,140,120,105,66,54,29,17],K:[159,148,144,135,120,105,90,60,48,27,16],L:[115,113,111,106,95,80,70,52,42,26,16],M:[100,97,94,90,80,70,59,47,34,25,16]}},DESCRIPTIONS={clarity:new function(){this.IF="Internally flawless. No inclusions and only blemishes are visible to a skilled grader using 10× magnification.",this.VVS1="Very very small inclusions.  Inclusions are difficult for a skilled grader to see under 10× magnification.",this.VVS2=this.VVS1,this.VS1="Very small inclusions. Inclusions are minor and range from difficult to somewhat easy for a skilled grader to see under 10x magnification, and in some cases to the naked eye.",this.VS2=this.VS1,this.SI1="Small inclusions. Inclusions are noticeable to a skilled grader under 10x magnification, and may be visible to the naked eye.",this.SI2=this.SI1,this.SI3=this.SI1,this.I1="Imperfect. Inclusions are obvious under 10× magnification, in most cases to the naked eye, and may affect transparency and brilliance.",this.I2=this.I1,this.I3=this.I1},color:new function(){this.D="Colorless",this.E=this.D,this.F=this.D,this.G="Near Colorless",this.H=this.G,this.I=this.G,this.J=this.G,this.K="Faint",this.L=this.K,this.M=this.K}},DiamondModel=Backbone.Model.extend({defaults:{carat:1,color:2,clarity:3}});diamondModel=new DiamondModel;var CharacteristicView=Backbone.View.extend({disable:function(buttonClass){this.$el.find(buttonClass).prop("disabled",!0)},enable:function(buttonClass){this.$el.find(buttonClass).prop("disabled",!1)},increment:function(e){var charName=this.options.characteristic,newValue=this.model.get(charName)-1;e.preventDefault(),this.enable(".decrement-button"),this.model.set(charName,newValue),0===newValue&&this.disable(".increment-button")},decrement:function(e){var charName=this.options.characteristic,newValue=this.model.get(charName)+1;e.preventDefault(),this.enable(".increment-button"),this.model.set(charName,newValue),newValue>=BOUNDS[charName]&&this.disable(".decrement-button")},events:{"click .increment-button":"increment","click .decrement-button":"decrement"},initialize:function(options){this.options=options||{};var charName=options.characteristic;this.setElement("#"+charName+"-view"),this.listenTo(this.model,"change:"+charName,this.render),this.render()},render:function(){var charName=(this.$el,this.options.characteristic),val=this.model.get(this.options.characteristic),prettyName=CONSTANTS[charName][val],description=DESCRIPTIONS[charName][prettyName];this.$el.find(".value").html(prettyName),this.$el.find(".description").html(description),this.$el.find("#"+charName+"-diagram").attr("class",charName+"-diagram-"+prettyName)}});colorView=new CharacteristicView({characteristic:"color",model:diamondModel}),clarityView=new CharacteristicView({characteristic:"clarity",model:diamondModel});var CaratView=CharacteristicView.extend({increment:function(e){var newValue=+(this.model.get("carat")+.01).toFixed(2);e.preventDefault(),this.model.set("carat",newValue)},decrement:function(e){var newValue=+(this.model.get("carat")-.01).toFixed(2);e.preventDefault(),this.model.set("carat",newValue)},changeInput:function(){var newVal=this.$el.find(".value input").val();this.model.set("carat",+newVal)},events:{"click .increment-button":"increment","click .decrement-button":"decrement","change input":"changeInput"},render:function(){this.$el.find("input").val(this.model.get("carat"))}});caratView=new CaratView({el:"#carat-view",characteristic:"carat",model:diamondModel});var PriceView=Backbone.View.extend({initialize:function(){this.listenTo(this.model,"change",this.render),this.render()},render:function(){var totalCost=getTotalCost(this.model.attributes);this.$el.find(".value").html(totalCost)}});priceView=new PriceView({model:diamondModel,el:"#price-view"});